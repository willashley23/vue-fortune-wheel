(function(t){function e(e){for(var i,o,s=e[0],l=e[1],c=e[2],u=0,d=[];u<s.length;u++)o=s[u],Object.prototype.hasOwnProperty.call(r,o)&&r[o]&&d.push(r[o][0]),r[o]=0;for(i in l)Object.prototype.hasOwnProperty.call(l,i)&&(t[i]=l[i]);f&&f(e);while(d.length)d.shift()();return a.push.apply(a,c||[]),n()}function n(){for(var t,e=0;e<a.length;e++){for(var n=a[e],i=!0,s=1;s<n.length;s++){var l=n[s];0!==r[l]&&(i=!1)}i&&(a.splice(e--,1),t=o(o.s=n[0]))}return t}var i={},r={app:0},a=[];function o(e){if(i[e])return i[e].exports;var n=i[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.m=t,o.c=i,o.d=function(t,e,n){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},o.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)o.d(n,i,function(e){return t[e]}.bind(null,i));return n},o.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="/";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],l=s.push.bind(s);s.push=e,s=s.slice();for(var c=0;c<s.length;c++)e(s[c]);var f=l;a.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("cd49")},"102d":function(t,e,n){},"1fb8":function(t,e,n){"use strict";n("102d")},"5a8b":function(t,e,n){},c67e:function(t,e,n){},cd49:function(t,e,n){"use strict";n.r(e);n("e260"),n("e6cf"),n("cca6"),n("a79d");var i=n("2b0e"),r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"container",attrs:{id:"app"}},[n("div",{staticClass:"row"},[n("div",{staticClass:"col-md-6"},[n("h2",[t._v(" Canvas ")]),n("FortuneWheel",{staticStyle:{width:"500px","max-width":"100%"},attrs:{verify:t.canvasVerify,canvas:t.canvasOptions,prizes:t.prizesCanvas},on:{rotateStart:t.onCanvasRotateStart,rotateEnd:t.onRotateEnd}})],1)])])},a=[],o=(n("d3b7"),function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"fw-container"},[n("div",{staticClass:"fw-wheel",style:t.rotateStyle,on:{transitionend:t.onRotateEnd,webkitTransitionend:t.onRotateEnd}},["canvas"===t.type?n("canvas",{ref:"wheel",attrs:{width:2*t.canvasConfig.radius,height:2*t.canvasConfig.radius}}):t._t("wheel")],2),n("div",{staticClass:"fw-btn"},["canvas"===t.type?n("div",{staticClass:"fw-btn__btn",style:{width:t.canvasConfig.btnWidth+"px",height:t.canvasConfig.btnWidth+"px"},on:{click:t.handleClick}},[t._v(" "+t._s(t.canvasConfig.btnText)+" ")]):n("div",{staticClass:"fw-btn__image",on:{click:t.handleClick}},[t._t("button")],2)])])}),s=[],l=n("2909"),c=(n("498a"),n("ac1f"),n("5319"),n("a9e3"),n("d81d"),n("4e82"),n("1276"),n("d9e2"),n("159b"),n("cb29"),n("b0c0"),n("c740"),n("6bd8")),f=n.n(c),u=n("0f40"),d=n.n(u),h={radius:250,textRadius:190,textLength:6,textDirection:"horizontal",lineHeight:20,borderWidth:0,borderColor:"transparent",btnText:"GO",btnWidth:140,fontSize:34};function p(t,e){var n=[];while(""!==t){var i=t.substr(0,e);if(""!==t.charAt(e)&&" "!==t.charAt(e)){var r=i.lastIndexOf(" ");-1!==r&&(i=i.substr(0,r))}t=t.replace(i,"").trim(),n.push(i)}return n}var b=i["a"].extend({name:"FortuneWheel",props:{type:{type:String,default:"canvas"},useWeight:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},verify:{type:Boolean,default:!1},canvas:{type:Object,default:function(){return h}},duration:{type:Number,default:6e3},timingFun:{type:String,default:"cubic-bezier(0.36, 0.95, 0.64, 1)"},angleBase:{type:Number,default:10},prizeId:{type:Number,default:0},prizes:{type:Array,required:!0,default:function(){return[]}}},data:function(){return{isRotating:!1,rotateEndDeg:0,prizeRes:{}}},computed:{canvasConfig:function(){return Object.assign(h,this.canvas)},probabilityTotal:function(){return this.useWeight?100:f()(this.prizes,(function(t){return t.probability||0}))},prizesIdArr:function(){return this.prizes.map((function(t){return t.id}))},decimalSpaces:function(){if(this.useWeight)return 0;var t=Object(l["a"])(this.prizes).sort((function(t,e){var n=String(t.probability).split(".")[1],i=String(e.probability).split(".")[1],r=n?n.length:0,a=i?i.length:0;return a-r})),e=String(t[0].probability).split(".")[1],n=e?e.length:0;return[1,10,100,1e3,1e4][n>4?4:n]},rotateStyle:function(){return{"-webkit-transform":"rotateZ(".concat(this.rotateEndDeg,"deg)"),transform:"rotateZ(".concat(this.rotateEndDeg,"deg)"),"-webkit-transition-duration":"".concat(this.rotateDuration,"s"),"transition-duration":"".concat(this.rotateDuration,"s"),"-webkit-transition-timing-function:":this.timingFun,"transition-timing-function":this.timingFun}},rotateDuration:function(){return this.isRotating?this.duration/1e3:0},rotateBase:function(){var t=360*this.angleBase;return this.angleBase<0&&(t-=360),t},canRotate:function(){return!this.disabled&&!this.isRotating&&100===Math.floor(this.probabilityTotal)}},watch:{prizeId:function(t){if(this.isRotating){var e=this.getTargetDeg(t);this.angleBase<0&&(e-=360);var n=this.rotateEndDeg,i=360*this.angleBase+e,r=360*Math.floor((i-n)/360);this.angleBase>=0?i+=Math.abs(r):i+=-360-r,this.rotateEndDeg=i}}},created:function(){this.checkProbability()},mounted:function(){"canvas"===this.type&&this.drawCanvas()},methods:{checkProbability:function(){if(100!==Math.floor(this.probabilityTotal))throw new Error("Prizes Is Error: Sum of probabilities is not 100!");return!0},drawCanvas:function(){var t=this,e=this.$refs.wheel;if(e.getContext){var n=this.canvasConfig,i=n.radius,r=n.textRadius,a=n.borderWidth,o=n.borderColor,s=n.fontSize,l=Math.PI/(this.prizes.length/2),c=e.getContext("2d");c.clearRect(0,0,2*i,2*i),c.strokeStyle=o,c.lineWidth=2*a,c.font="".concat(s,"px Arial"),this.prizes.forEach((function(e,n){var o=n*l-Math.PI/2;c.fillStyle=e.bgColor,c.beginPath(),c.arc(i,i,i-a,o,o+l,!1),c.stroke(),c.arc(i,i,0,o+l,o,!0),c.fill(),c.save(),c.fillStyle=e.color,c.translate(i+Math.cos(o+l/2)*r,i+Math.sin(o+l/2)*r),t.drawPrizeText(c,o,l,e.name),c.restore()}))}},drawPrizeText:function(t,e,n,i){var r=this.canvasConfig,a=r.lineHeight,o=r.textLength,s=r.textDirection,l=p(i,o);null!==l&&("vertical"===s?t.rotate(e+n/2+Math.PI):t.rotate(e+n/2+Math.PI/2),l.forEach((function(e,n){var i=-t.measureText(e).width/2,r=(n+1)*a;"vertical"===s&&(i=0,r=(n+1)*a-l.length*a/2),t.fillText(e,i,r)})))},handleClick:function(){this.canRotate&&(this.verify?this.$emit("rotateStart",this.onRotateStart):(this.$emit("rotateStart"),this.onRotateStart()))},onRotateStart:function(){this.isRotating=!0;var t=this.prizeId||this.getRandomPrize();this.rotateEndDeg=this.rotateBase+this.getTargetDeg(t)},onRotateEnd:function(){this.isRotating=!1,this.rotateEndDeg%=360,this.$emit("rotateEnd",this.prizeRes)},getRandomPrize:function(){var t=this.prizesIdArr.length,e=this.prizesIdArr[d()(0,t-1)];return e},getTargetDeg:function(t){var e=360/this.prizes.length,n=this.prizes.findIndex((function(e){return e.id===t}));return this.prizeRes=this.prizes[n],360-(e*n+e/2)}}}),v=b,g=(n("ead1"),n("2877")),y=Object(g["a"])(v,o,s,!1,null,"7b87abe8",null),m=y.exports,w=i["a"].extend({name:"App",components:{FortuneWheel:m},data:function(){return{prizeId:0,canvasVerify:!1,canvasOptions:{btnWidth:140,borderColor:"#584b43",borderWidth:6,lineHeight:30},prizesCanvas:[{id:1,name:"Blue",value:"Blue's value",bgColor:"#45ace9",color:"#ffffff",probability:16.666666666666668},{id:2,name:"Red",value:"Red's value",bgColor:"#dd3832",color:"#ffffff",probability:16.666666666666668},{id:3,name:"Yellow",value:"Yellow's value",bgColor:"#fef151",color:"#ffffff",probability:16.666666666666668},{id:4,name:"Yellow",value:"Yellow's value",bgColor:"#fef151",color:"#ffffff",probability:16.666666666666668},{id:5,name:"Yellow",value:"Yellow's value",bgColor:"#fef151",color:"#ffffff",probability:16.666666666666668},{id:6,name:"Yellow",value:"Yellow's value",bgColor:"#fef151",color:"#ffffff",probability:16.666666666666668}]}},methods:{onCanvasRotateStart:function(t){var e=this;if(this.canvasVerify){var n=!0;this.DoServiceVerify(n,2e3).then((function(n){n?(console.log("验证通过, 开始旋转"),t(),e.canvasVerify=!1):alert("未通过验证")}))}else console.log("onCanvasRotateStart")},onImageRotateStart:function(){console.log("onImageRotateStart")},onRotateEnd:function(t){alert(t.value)},onChangePrize:function(t){this.prizeId=t},DoServiceVerify:function(t,e){return new Promise((function(n){setTimeout((function(){n(t)}),e)}))}}}),C=w,z=(n("1fb8"),Object(g["a"])(C,r,a,!1,null,"be9d2826",null)),S=z.exports;n("f5df1"),n("5a8b");i["a"].config.productionTip=!1,new i["a"]({render:function(t){return t(S)}}).$mount("#app")},ead1:function(t,e,n){"use strict";n("c67e")}});
//# sourceMappingURL=app.bcf01338.js.map